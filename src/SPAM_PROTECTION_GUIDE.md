# üõ°Ô∏è –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∑–∞—â–∏—Ç–µ –æ—Ç —Å–ø–∞–º–∞ –∏ Rate Limiting

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã –∑–∞—â–∏—Ç—ã](#–æ–±–∑–æ—Ä-—Å–∏—Å—Ç–µ–º—ã-–∑–∞—â–∏—Ç—ã)
2. [–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
3. [–•—É–∫–∏](#—Ö—É–∫–∏)
4. [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
5. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–∏–º–∏—Ç–æ–≤](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–ª–∏–º–∏—Ç–æ–≤)
6. [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥](#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)

---

## üéØ –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã –∑–∞—â–∏—Ç—ã

### 6-—É—Ä–æ–≤–Ω–µ–≤–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞

1. **URL —Ñ–∏–ª—å—Ç—Ä** - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Å—Å—ã–ª–∫–∞–º–∏
2. **–ü–∞—Ç—Ç–µ—Ä–Ω –∞–Ω–∞–ª–∏–∑** - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —Å–∏–º–≤–æ–ª–æ–≤ (aaaa, !!!!)
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª–æ–≤** - –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
4. **–î—É–±–ª–∏–∫–∞—Ç—ã** - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
5. **–°–ø–∞–º-–∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞** - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å–ª–æ–≤–∞—Ä—é
6. **Honeypot** - –°–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ –¥–ª—è –ª–æ–≤–ª–∏ –±–æ—Ç–æ–≤

### Rate Limiting

| –î–µ–π—Å—Ç–≤–∏–µ | –õ–∏–º–∏—Ç | –û–∫–Ω–æ | –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ |
|----------|-------|------|------------|
| **–í—Ö–æ–¥** | 5 –ø–æ–ø—ã—Ç–æ–∫ | 15 –º–∏–Ω—É—Ç | 30 –º–∏–Ω—É—Ç |
| **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** | 3 –ø–æ–ø—ã—Ç–∫–∏ | 1 —á–∞—Å | 2 —á–∞—Å–∞ |
| **–°–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è** | 3 –ø–æ–ø—ã—Ç–∫–∏ | 1 —á–∞—Å | 1 —á–∞—Å |
| **–ü–æ–∫–∞–∑–∞–Ω–∏—è —Å—á—ë—Ç—á–∏–∫–æ–≤** | 5 –æ—Ç–ø—Ä–∞–≤–æ–∫ | 1 —á–∞—Å | - |
| **–ó–∞—è–≤–∫–∏ –Ω–∞ —Ä–µ–º–æ–Ω—Ç** | 10 –∑–∞—è–≤–æ–∫ | 24 —á–∞—Å–∞ | - |
| **–û–ø–ª–∞—Ç–∞** | 5 –ø–æ–ø—ã—Ç–æ–∫ | 1 —á–∞—Å | 2 —á–∞—Å–∞ |
| **–ê–¥–º–∏–Ω-–≤—Ö–æ–¥** | 5 –ø–æ–ø—ã—Ç–æ–∫ | 15 –º–∏–Ω—É—Ç | 30 –º–∏–Ω—É—Ç |

---

## üß© –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. RateLimitIndicator

–í–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ª–∏–º–∏—Ç–∞ –ø–æ–ø—ã—Ç–æ–∫.

```tsx
import { RateLimitIndicator } from './components/RateLimitIndicator';

<RateLimitIndicator
  remainingAttempts={3}
  maxAttempts={5}
  lockoutTime={1800} // —Å–µ–∫—É–Ω–¥—ã
  isLocked={false}
  actionType="–≤—Ö–æ–¥–∞"
/>
```

**–í–∏–∑—É–∞–ª—å–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è:**
- üü¢ 80-100% –ø–æ–ø—ã—Ç–æ–∫ - –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è
- üîµ 60-80% - —Å–∏–Ω–∏–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
- üü° 40-60% - –∂—ë–ª—Ç—ã–π —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º
- üî¥ 0-40% - –∫—Ä–∞—Å–Ω—ã–π —Å —Å–µ—Ä—å—ë–∑–Ω—ã–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º
- üö´ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ - –∫—Ä–∞—Å–Ω—ã–π —Å —Ç–∞–π–º–µ—Ä–æ–º —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

---

### 2. SpamProtection

–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Å–ø–∞–º–∞.

```tsx
import { SpamProtection } from './components/SpamProtection';

<SpamProtection
  isSpam={true}
  confidence={85}
  reason="–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã —Å–ø–∞–º-–∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞"
  showDetails={true}
/>
```

---

### 3. SecurityDashboard

–ü–∞–Ω–µ–ª—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

```tsx
import { SecurityDashboard } from './components/SecurityDashboard';

// –í –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
<SecurityDashboard />
```

**–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç:**
- –û–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ–ø—ã—Ç–æ–∫
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
- –ê–∫—Ç–∏–≤–Ω—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- –ù–µ–¥–∞–≤–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –°—Ç–∞—Ç—É—Å –∑–∞—â–∏—Ç—ã –æ—Ç —Å–ø–∞–º–∞

---

### 4. ProtectedForm

HOC –¥–ª—è –∑–∞—â–∏—Ç—ã —Ñ–æ—Ä–º.

```tsx
import { ProtectedForm } from './components/ProtectedForm';
import { ActionType } from '../utils/antiSpam';

<ProtectedForm
  identifier={user.phone} // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  actionType={ActionType.METER_SUBMISSION}
  onSubmit={handleSubmit}
  submitButtonText="–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–∫–∞–∑–∞–Ω–∏—è"
  checkSpam={true}
  spamCheckFields={['meterValue', 'notes']}
  showSecurityIndicators={true}
>
  {({ formData, updateFormData, isSubmitting }) => (
    <>
      <Input
        value={formData.meterValue || ''}
        onChange={(e) => updateFormData('meterValue', e.target.value)}
        disabled={isSubmitting}
      />
    </>
  )}
</ProtectedForm>
```

---

## ü™ù –•—É–∫–∏

### useRateLimit

–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ rate limiting –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è.

```tsx
import { useRateLimit } from '../hooks/useRateLimit';
import { ActionType } from '../utils/antiSpam';

function LoginForm() {
  const rateLimit = useRateLimit(
    userPhone, // identifier
    ActionType.LOGIN
  );

  const handleLogin = async () => {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞
    if (!rateLimit.checkLimit()) {
      toast.error(rateLimit.message);
      return;
    }

    try {
      await login();
      rateLimit.recordAttempt(true); // –£—Å–ø–µ—Ö
    } catch (error) {
      rateLimit.recordAttempt(false); // –ù–µ—É–¥–∞—á–∞
    }
  };

  return (
    <div>
      <RateLimitIndicator
        remainingAttempts={rateLimit.remainingAttempts}
        maxAttempts={5}
        isLocked={rateLimit.isLocked}
        lockoutTime={rateLimit.lockoutTime}
      />
      
      <Button 
        onClick={handleLogin}
        disabled={rateLimit.isLocked || !rateLimit.allowed}
      >
        –í–æ–π—Ç–∏
      </Button>
    </div>
  );
}
```

---

### useSpamDetection

–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–ø–∞–º–∞ –≤ –∫–æ–Ω—Ç–µ–Ω—Ç–µ.

```tsx
import { useSpamDetection } from '../hooks/useSpamDetection';

function MessageForm({ userId }) {
  const spam = useSpamDetection(userId);
  const [message, setMessage] = useState('');

  const handleSubmit = () => {
    const result = spam.checkContent(message);
    
    if (result.isSpam) {
      toast.error(`–°–ø–∞–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω: ${result.reason}`);
      return;
    }

    // –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
  };

  return (
    <div>
      <Textarea
        value={message}
        onChange={(e) => setMessage(e.target.value)}
      />
      
      {spam.isSpam && (
        <SpamProtection
          isSpam={spam.isSpam}
          confidence={spam.confidence}
          reason={spam.reason}
        />
      )}
      
      <Button onClick={handleSubmit}>–û—Ç–ø—Ä–∞–≤–∏—Ç—å</Button>
    </div>
  );
}
```

---

### useFormSpamProtection

–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –∑–∞—â–∏—Ç–∞ —Ñ–æ—Ä–º—ã.

```tsx
import { useFormSpamProtection } from '../hooks/useSpamDetection';

function RequestForm({ userId }) {
  const protection = useFormSpamProtection(userId);
  const [formData, setFormData] = useState({
    title: '',
    description: ''
  });

  const handleSubmit = () => {
    const validation = protection.validateFormData(formData);
    
    if (!validation.isValid) {
      // –ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫–∏
      Object.entries(validation.errors).forEach(([field, error]) => {
        toast.error(`${field}: ${error}`);
      });
      return;
    }

    // –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ä–º—É
  };

  return (
    <div>
      <form onSubmit={handleSubmit}>
        {/* –ü–æ–ª—è —Ñ–æ—Ä–º—ã */}
      </form>

      {/* –ú–æ–Ω–∏—Ç–æ—Ä –∑–∞—â–∏—Ç—ã */}
      <AntiSpamMonitor
        totalBlocked={protection.blockedCount}
        recentAttempts={protection.recentAttempts}
        lastBlockedTime={protection.lastBlockedTime}
      />
    </div>
  );
}
```

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ó–∞—â–∏—Ç–∞ —Ñ–æ—Ä–º—ã –≤—Ö–æ–¥–∞

```tsx
import { useState } from 'react';
import { useRateLimit } from '../hooks/useRateLimit';
import { ActionType } from '../utils/antiSpam';
import { RateLimitIndicator } from './RateLimitIndicator';

function LoginForm() {
  const [phone, setPhone] = useState('');
  const [pin, setPin] = useState('');
  const rateLimit = useRateLimit(phone, ActionType.LOGIN);

  const handleLogin = async (e: React.FormEvent) => {
    e.preventDefault();

    // –ü—Ä–æ–≤–µÔøΩÔøΩ–∫–∞ –ª–∏–º–∏—Ç–∞
    if (!rateLimit.allowed) {
      return;
    }

    try {
      const result = await authenticateUser(phone, pin);
      
      if (result.success) {
        rateLimit.recordAttempt(true); // –°–±—Ä–æ—Å–∏—Ç—å —Å—á—ë—Ç—á–∏–∫
        toast.success('–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω');
      } else {
        rateLimit.recordAttempt(false); // –£–≤–µ–ª–∏—á–∏—Ç—å —Å—á—ë—Ç—á–∏–∫
        toast.error('–ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ');
      }
    } catch (error) {
      rateLimit.recordAttempt(false);
    }
  };

  return (
    <form onSubmit={handleLogin}>
      <RateLimitIndicator
        remainingAttempts={rateLimit.remainingAttempts}
        maxAttempts={5}
        isLocked={rateLimit.isLocked}
        lockoutTime={rateLimit.lockoutTime}
        actionType="–≤—Ö–æ–¥–∞"
      />

      <Input
        value={phone}
        onChange={(e) => setPhone(e.target.value)}
        placeholder="–¢–µ–ª–µ—Ñ–æ–Ω"
        disabled={rateLimit.isLocked}
      />

      <Input
        type="password"
        value={pin}
        onChange={(e) => setPin(e.target.value)}
        placeholder="PIN"
        disabled={rateLimit.isLocked}
      />

      <Button 
        type="submit"
        disabled={rateLimit.isLocked || !rateLimit.allowed}
      >
        –í–æ–π—Ç–∏
      </Button>
    </form>
  );
}
```

---

### –ü—Ä–∏–º–µ—Ä 2: –ó–∞—â–∏—Ç–∞ —Ñ–æ—Ä–º—ã –æ–±—ä—è–≤–ª–µ–Ω–∏–π

```tsx
import { useState } from 'react';
import { useRateLimit } from '../hooks/useRateLimit';
import { useSpamDetection } from '../hooks/useSpamDetection';
import { ActionType } from '../utils/antiSpam';

function AnnouncementForm({ adminId }) {
  const [title, setTitle] = useState('');
  const [content, setContent] = useState('');
  
  const rateLimit = useRateLimit(adminId, ActionType.FORM_SUBMISSION);
  const titleSpam = useSpamDetection(`${adminId}-title`);
  const contentSpam = useSpamDetection(`${adminId}-content`);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();

    // Rate limit check
    if (!rateLimit.checkLimit()) {
      toast.error('–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ–ø—ã—Ç–æ–∫');
      return;
    }

    // Spam check
    const titleCheck = titleSpam.checkContent(title);
    const contentCheck = contentSpam.checkContent(content);

    if (titleCheck.isSpam) {
      toast.error(`–°–ø–∞–º –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ: ${titleCheck.reason}`);
      rateLimit.recordAttempt(false);
      return;
    }

    if (contentCheck.isSpam) {
      toast.error(`–°–ø–∞–º –≤ —Ç–µ–∫—Å—Ç–µ: ${contentCheck.reason}`);
      rateLimit.recordAttempt(false);
      return;
    }

    try {
      await createAnnouncement({ title, content });
      rateLimit.recordAttempt(true);
      toast.success('–û–±—ä—è–≤–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ');
    } catch (error) {
      rateLimit.recordAttempt(false);
      toast.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è');
    }
  };

  return (
    <form onSubmit={handleSubmit}>
      <div className="space-y-4">
        <div>
          <Input
            value={title}
            onChange={(e) => setTitle(e.target.value)}
            placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫"
          />
          {titleSpam.isSpam && (
            <SpamProtection
              isSpam={true}
              confidence={titleSpam.confidence}
              reason={titleSpam.reason}
            />
          )}
        </div>

        <div>
          <Textarea
            value={content}
            onChange={(e) => setContent(e.target.value)}
            placeholder="–¢–µ–∫—Å—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è"
          />
          {contentSpam.isSpam && (
            <SpamProtection
              isSpam={true}
              confidence={contentSpam.confidence}
              reason={contentSpam.reason}
            />
          )}
        </div>

        <RateLimitIndicator
          remainingAttempts={rateLimit.remainingAttempts}
          maxAttempts={20}
          isLocked={rateLimit.isLocked}
        />

        <Button 
          type="submit"
          disabled={
            rateLimit.isLocked || 
            titleSpam.isSpam || 
            contentSpam.isSpam
          }
        >
          –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å
        </Button>
      </div>
    </form>
  );
}
```

---

### –ü—Ä–∏–º–µ—Ä 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ProtectedForm

```tsx
import { ProtectedForm } from './ProtectedForm';
import { ActionType } from '../utils/antiSpam';

function MeterSubmissionForm({ user }) {
  const handleSubmit = async (formData: any) => {
    // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–∫–∞–∑–∞–Ω–∏—è
    await submitMeterReading({
      userId: user.id,
      value: formData.meterValue,
      notes: formData.notes
    });
  };

  return (
    <ProtectedForm
      identifier={user.phone}
      actionType={ActionType.METER_SUBMISSION}
      onSubmit={handleSubmit}
      submitButtonText="–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–∫–∞–∑–∞–Ω–∏—è"
      checkSpam={true}
      spamCheckFields={['notes']}
      showSecurityIndicators={true}
    >
      {({ formData, updateFormData, isSubmitting }) => (
        <div className="space-y-4">
          <div>
            <Label>–ü–æ–∫–∞–∑–∞–Ω–∏—è —Å—á—ë—Ç—á–∏–∫–∞</Label>
            <Input
              type="number"
              value={formData.meterValue || ''}
              onChange={(e) => updateFormData('meterValue', e.target.value)}
              disabled={isSubmitting}
              placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è"
            />
          </div>

          <div>
            <Label>–ü—Ä–∏–º–µ—á–∞–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</Label>
            <Textarea
              value={formData.notes || ''}
              onChange={(e) => updateFormData('notes', e.target.value)}
              disabled={isSubmitting}
              placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è"
            />
          </div>
        </div>
      )}
    </ProtectedForm>
  );
}
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–∏–º–∏—Ç–æ–≤

–õ–∏–º–∏—Ç—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ `/utils/antiSpam.ts`:

```typescript
const RATE_LIMIT_CONFIGS: Record<ActionType, RateLimitConfig> = {
  [ActionType.LOGIN]: {
    maxAttempts: 5,           // –ú–∞–∫—Å–∏–º—É–º –ø–æ–ø—ã—Ç–æ–∫
    windowMs: 15 * 60 * 1000, // –û–∫–Ω–æ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
    lockoutMs: 30 * 60 * 1000 // –í—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
  },
  // ... –¥—Ä—É–≥–∏–µ —Ç–∏–ø—ã –¥–µ–π—Å—Ç–≤–∏–π
};
```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤

```typescript
// –£–≤–µ–ª–∏—á–∏—Ç—å –ª–∏–º–∏—Ç –≤—Ö–æ–¥–æ–≤ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
[ActionType.LOGIN]: {
  maxAttempts: 10,          // –ë—ã–ª–æ: 5
  windowMs: 15 * 60 * 1000,
  lockoutMs: 15 * 60 * 1000 // –ë—ã–ª–æ: 30 –º–∏–Ω—É—Ç
}
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –í –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

```tsx
import { SecurityDashboard } from './components/SecurityDashboard';

function AdminPanel() {
  return (
    <Tabs>
      <TabsList>
        <TabsTrigger value="security">
          <Shield className="w-4 h-4 mr-2" />
          –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
        </TabsTrigger>
      </TabsList>

      <TabsContent value="security">
        <SecurityDashboard />
      </TabsContent>
    </Tabs>
  );
}
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```typescript
// –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
const events = JSON.parse(
  localStorage.getItem('security_events') || '[]'
);

// –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É
const failedLogins = events.filter(
  e => e.type === 'failed_login'
);

// –ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
const recentEvents = events.filter(
  e => e.timestamp > Date.now() - 60 * 60 * 1000
);
```

---

## üîß –£—Ç–∏–ª–∏—Ç—ã

### –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π

```typescript
import { rateLimiter } from '../utils/antiSpam';

// –û—á–∏—Å—Ç–∏—Ç—å –∑–∞–ø–∏—Å–∏ —Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤
rateLimiter.cleanup();
```

### –°–±—Ä–æ—Å –ª–∏–º–∏—Ç–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```typescript
import { rateLimiter, ActionType } from '../utils/antiSpam';

// –°–±—Ä–æ—Å–∏—Ç—å –ª–∏–º–∏—Ç –≤—Ö–æ–¥–∞
rateLimiter.reset(userPhone, ActionType.LOGIN);
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

```typescript
const stats = rateLimiter.getStats(userPhone, ActionType.LOGIN);

console.log({
  totalAttempts: stats.totalAttempts,
  remainingAttempts: stats.remainingAttempts,
  isLocked: stats.isLocked,
  firstAttempt: stats.firstAttempt,
  lastAttempt: stats.lastAttempt
});
```

---

## üé® –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞

```tsx
<RateLimitIndicator
  // ... props
  className="custom-class"
/>

// –í CSS
.custom-class {
  /* –í–∞—à–∏ —Å—Ç–∏–ª–∏ */
}
```

### –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞

```tsx
function CustomRateLimitIndicator({ remainingAttempts, maxAttempts }) {
  const percentage = (remainingAttempts / maxAttempts) * 100;
  
  return (
    <div className="flex items-center gap-2">
      <Progress value={percentage} />
      <span>{remainingAttempts} / {maxAttempts}</span>
    </div>
  );
}
```

---

## üöÄ Best Practices

### 1. –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ rate limit –ø–µ—Ä–µ–¥ –¥–µ–π—Å—Ç–≤–∏–µ–º

```tsx
‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
if (!rateLimit.checkLimit()) {
  return;
}

‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–π—Å—Ç–≤–∏—è
```

### 2. –ó–∞–ø–∏—Å—ã–≤–∞–π—Ç–µ —É—Å–ø–µ—à–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏

```tsx
‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
if (success) {
  rateLimit.recordAttempt(true); // –°–±—Ä–æ—Å–∏—Ç —Å—á—ë—Ç—á–∏–∫
}

‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
// –ù–µ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å —É—Å–ø–µ—Ö = —Å—á—ë—Ç—á–∏–∫ –Ω–µ —Å–±—Ä–æ—Å–∏—Ç—Å—è
```

### 3. –ü–æ–∫–∞–∑—ã–≤–∞–π—Ç–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞—Ä–∞–Ω–µ–µ

```tsx
‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
// –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–∏ 2+ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–∫–∞—Ö
{loginAttempts >= 2 && <RateLimitIndicator />}

‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
// –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ
{isLocked && <RateLimitIndicator />}
```

### 4. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å–ø–∞–º –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

```tsx
‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
const handleChange = (value: string) => {
  setValue(value);
  spam.checkContent(value); // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–∞–∑—É
};

‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ submit
```

### 5. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ debounce –¥–ª—è –ø—Ä–æ–≤–µ—Ä–æ–∫

```tsx
import { debounce } from '../utils/antiSpam';

const debouncedSpamCheck = debounce((value: string) => {
  spam.checkContent(value);
}, 500);
```

---

## üìû Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–µ —Å–Ω–∏–º–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
const stats = rateLimiter.getStats(identifier, actionType);
console.log('Locked until:', new Date(stats.lastAttempt + lockoutMs));

// –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å
rateLimiter.reset(identifier, actionType);
```

### –ü—Ä–æ–±–ª–µ–º–∞: –õ–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è —Å–ø–∞–º-—Ñ–∏–ª—å—Ç—Ä–∞

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
spamDetector.clearHistory(userId);

// –ò–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –±–æ–ª–µ–µ –º—è–≥–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ antiSpam.ts
```

### –ü—Ä–æ–±–ª–µ–º–∞: –°—á—ë—Ç—á–∏–∫ –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–¥–∏–Ω identifier
const rateLimit = useRateLimit(userId, ActionType.LOGIN);
//                              ^^^^^^ –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º
```

---

## üìö API Reference

### ActionType

```typescript
enum ActionType {
  LOGIN = 'login',
  REGISTRATION = 'registration',
  PASSWORD_RESET = 'password_reset',
  METER_SUBMISSION = 'meter_submission',
  REQUEST_SUBMISSION = 'request_submission',
  PAYMENT = 'payment',
  ADMIN_LOGIN = 'admin_login',
  FORM_SUBMISSION = 'form_submission',
  API_CALL = 'api_call'
}
```

### RateLimiter Methods

```typescript
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–º–∏—Ç
checkLimit(identifier: string, action: ActionType): {
  allowed: boolean;
  remainingAttempts: number;
  resetTime?: number;
  lockoutTime?: number;
  message?: string;
}

// –ó–∞–ø–∏—Å–∞—Ç—å –ø–æ–ø—ã—Ç–∫—É
recordAttempt(identifier: string, action: ActionType, success?: boolean): void

// –°–±—Ä–æ—Å–∏—Ç—å —Å—á—ë—Ç—á–∏–∫
reset(identifier: string, action: ActionType): void

// –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
getStats(identifier: string, action: ActionType): {
  totalAttempts: number;
  remainingAttempts: number;
  firstAttempt?: Date;
  lastAttempt?: Date;
  isLocked: boolean;
}

// –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏
cleanup(): void
```

### SpamDetector Methods

```typescript
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ —Å–ø–∞–º
isSpam(content: string, identifier: string): {
  isSpam: boolean;
  reason?: string;
  confidence: number;
}

// –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é
clearHistory(identifier: string): void
```

---

**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 30 –Ω–æ—è–±—Ä—è 2025  
**–ê–≤—Ç–æ—Ä:** Security Team
